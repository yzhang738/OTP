(function(b){var a=b.telerik;var e=/\s+/;a.list={initialize:function(){this.previousValue=this.value();a.bind(this,{dataBinding:this.onDataBinding,dataBound:this.onDataBound,error:this.onError,open:this.onOpen,close:this.onClose,valueChange:this.onChange,load:this.onLoad})},common:function(){this.open=function(){if(this.data.length==0){return}var f=this.$element;var h=this.dropDown;var g={offset:f.offset(),outerHeight:f.outerHeight(),outerWidth:f.outerWidth(),zIndex:a.getElementZIndex(f[0])};if(h.$items){h.open(g)}else{this.fill(function(){h.open(g)})}};this.close=function(){this.dropDown.close()};this.dataBind=function(g,f){this.data=g=(g||[]);var k=!!this.loader.isAjax();for(var l=0,h=g.length;l<h;l++){var j=g[l];if(j.Selected){this.index=l}if(this.encoded&&k&&!this.onDataBinding){g[l].Text=a.encode(j.Text)}}this.dropDown.dataBind(g);if(!f){this.text("");this.$input.val("")}};this.highlight=function(k){var f=function(l){var i=l.previousValue;var m=l.dropDown;l.close();m.dataBind(l.data);l.previousValue=i;m.$items.removeClass("t-state-selected").eq(g).addClass("t-state-selected")};var g=-1;if(!this.data){return g}if(!isNaN(k-0)){if(k>-1&&k<this.data.length){g=k;f(this)}}else{if(b.isFunction(k)){for(var j=0,h=this.data.length;j<h;j++){if(k(this.data[j])){g=j;break}}if(g!=-1){f(this)}}else{g=this.dropDown.highlight(k)}}return g}},filtering:function(){this.filter=function(p){p.isFiltered=true;var j=true;var l=p.data;var n=p.$text[0];var o=n.value;var k=p.trigger;var r=p.dropDown;o=this.multiple(o);if(o.length<p.minChars){return}var m=p.filter;if(p.loader.isAjax()){if(p.cache&&l&&l.length>0){p.filters[m](p,l,o);var f=p.filteredDataIndexes;if((f&&f.length>0)||(m==0&&p.selectedIndex!=-1)){j=false}}if(j){var i={};i[p.queryString.text]=o;p.loader.ajaxRequest(function(u){var v=p.trigger;var t=p.dropDown;if(u&&u.length==0){t.close();t.dataBind();return}if(p.encoded){for(var y=0,w=u.length;y<w;y++){var x=u[y];if(x.Text){u[y].Text=a.encode(x.Text)}else{u[y]=a.encode(x)}}}p.data=u;a.trigger(p.element,"dataBound");p.filters[m](p,u,o);var z=t.$items;if(z.length>0){if(!t.isOpened()){v.open()}p.filtering.autoFill(p,z.first().text())}else{v.close()}},{data:i})}}else{j=false;p.filters[m](p,p.data,o)}if(!j){var s=r.$items;var g=s.length;var h=p.selectedIndex;var q=m==0?h!=-1?s[h].innerText||s[h].textContent:"":s.length>0?s.first().text():"";this.autoFill(p,q);if(g==0){k.close()}else{if(!r.isOpened()){k.open()}}}};this.multiple=function(f){return f}},filters:function(){this.filters=[function f(k,h,n){if(!h||h.length==0){return}var g=k.dropDown;var j=g.$items;if(j.length==0||k.loader.isAjax()){g.dataBind(h);j=g.$items}for(var m=0,o=h.length;m<o;m++){if(h[m].Text.slice(0,n.length).toLowerCase()==n.toLowerCase()){var l=j[m];k.selectedIndex=m;g.highlight(l);g.scrollTo(l);return}}j.removeClass("t-state-selected");k.selectedIndex=-1;a.list.highlightFirstOnFilter(k,j)},d(false,function(g,h){return h.slice(0,g.length).toLowerCase()==g.toLowerCase()}),d(true,function(g,h){return h&&h.toLowerCase().indexOf(g.toLowerCase())!=-1})]},loader:function(f){this.ajaxError=false;this.component=f;this.isAjax=function(){return f.ajax||f.ws||f.onDataBinding};function g(i,j){var h={url:(f.ajax||f.ws)["selectUrl"],type:"POST",data:{},dataType:"text",error:function(l,k){f.loader.ajaxError=true;if(a.ajaxError(f.element,"error",l,k)){return}},complete:b.proxy(function(){this.hideBusy()},f.loader),success:function(n,l,m){try{n=eval("("+n+")")}catch(k){if(!a.ajaxError(f.element,"error",m,"parseeror")){alert("Error! The requested URL did not return JSON.")}f.loader.ajaxError=true;return}n=n.d||n;if(i){i.call(f,n)}}};b.extend(h,j);if(f.ws){h.data=a.toJson(h.data);h.contentType="application/json; charset=utf-8"}return h}this.ajaxRequest=function(i,j){var h={};if(a.trigger(f.element,"dataBinding",h)){return}if(f.ajax||f.ws){this.showBusy();b.ajax(g(i,{data:b.extend({},j?j.data:{},h.data)}))}else{if(i){i.call(f,f.data)}}},this.showBusy=function(){this.busyTimeout=setTimeout(b.proxy(function(){this.component.$element.find("> .t-dropdown-wrap .t-icon").addClass("t-loading")},this),100)},this.hideBusy=function(){clearTimeout(this.busyTimeout);this.component.$element.find("> .t-dropdown-wrap .t-icon").removeClass("t-loading")}},trigger:function(f){this.component=f;this.change=function(){var h=f.previousValue;var g=f.value();if(h==undefined||g!=h){a.trigger(f.element,"valueChange",{value:g})}f.previousValue=g};this.open=function(){var g=f.dropDown;if((g.$items&&g.$items.length>0)&&!g.isOpened()&&!a.trigger(f.element,"open")){f.open()}};this.close=function(){if(!f.dropDown.$element.is(":animated")&&f.dropDown.isOpened()&&!a.trigger(f.element,"close")){f.close()}}},highlightFirstOnFilter:function(f,g){if(f.highlightFirst){g.first().addClass("t-state-selected");f.dropDown.scrollTo(g[0])}},moveToEnd:function(g){if(g.createTextRange){var f=g.createTextRange();f.moveStart("textedit",1);f.select()}},selection:function(h,g,i){if(h.createTextRange){var f=h.createTextRange();f.collapse(true);f.moveStart("character",g);f.moveEnd("character",i-g);f.select()}else{if(h.selectionStart){h.selectionStart=g;h.selectionEnd=i}}},updateTextAndValue:function(g,f,i){g.text(f);var h=i===null?f:i;g.$input.val(h)},getZIndex:function(g){var f="auto";b(g).parents().andSelf().each(function(){f=b(this).css("zIndex");if(Number(f)){f=Number(f)+1;return false}});return f},keycodes:[8,9,13,27,37,38,39,40,35,36,46]};function d(g,f){return function(l,j,m){if(!j||j.length==0){return}var n=b.map(j,function(p,o){if(f(m,p.Text||p)){return o}});var h=n.length;var i=new RegExp("(?![^&;]+;)(?!<[^<>]*)("+m.replace(/([\^\$\(\)\[\]\{\}\*\.\+\?\|\\])/gi,"\\$1")+")(?![^<>]*>)(?![^&;]+;)",g?"ig":"i");l.filteredDataIndexes=n;l.selectedIndex=-1;l.dropDown.onItemCreate=function(o){if(m){o.html=o.html.replace(i,"<strong>$1</strong>")}};l.dropDown.dataBind(b.map(n,function(p,o){return j[p]}));var k=l.dropDown.$items;k.removeClass("t-state-selected");a.list.highlightFirstOnFilter(l,k)}}function c(f,g,j){if(!f||!g){return null}var l=j.length;j=j.toLowerCase();for(var k=0,h=f.length;k<h;k++){if(f[k].Text.slice(0,l).toLowerCase()==j){return g[k]}}}a.dropDownList=function(g,i){b.extend(this,i);var j="";var f=b(g);if(!f.attr("tabIndex")){f.attr("tabIndex",0)}this.element=g;this.$element=f;this.loader=new a.list.loader(this);this.trigger=new a.list.trigger(this);this.$text=f.find("> .t-dropdown-wrap > .t-input");this.$input=this.$element.find("input:last");this.dropDown=new a.dropDown({attr:this.dropDownAttr,effects:this.effects,onClick:b.proxy(function(m){this.select(m.item);this.trigger.change();this.trigger.close()},this)});this.dropDown.$element.css("direction",f.closest(".t-rtl").length?"rtl":"");this.fill=function(p){function m(t){var v;var u=t.selectedValue||t.value();if(u){v=function(x){return u==(x.Value||x.Text)}}else{var s=t.dropDown.$items;var w=t.index;var r=s.filter(".t-state-selected");var q=r.length;v=w!=-1&&w<s.length?w:q>0?q-1:0}t.select(v)}var o=this.dropDown;var n=this.loader;if(!o.$items&&!n.ajaxError){if(n.isAjax()){n.ajaxRequest(function(q){this.dataBind(q);m(this);a.trigger(this.element,"dataBound");this.trigger.change();if(p){p()}})}else{this.dataBind(this.data);m(this);if(p){p()}}}};this.enable=function(){f.removeClass("t-state-disabled").bind({keydown:b.proxy(k,this),keypress:b.proxy(l,this),click:b.proxy(function(m){var n=this.trigger;var o=this.dropDown;f.focus();if(o.isOpened()){n.close()}else{if(!o.$items){this.fill(n.open)}else{n.open()}}},this)})};this.disable=function(){f.addClass("t-state-disabled").unbind("click")};this.reload=function(){this.dropDown.$items=null;this.fill()};this.select=function(n){var m=this.highlight(n);if(m==-1){return m}this.selectedIndex=m;a.list.updateTextAndValue(this,this.data[m].Text,this.data[m].Value)};this.text=function(m){if(m!==undefined){this.$text.html(m&&m.replace(e,"")?m:"&nbsp")}else{return this.$text.html()}};this.value=function(m){if(m!==undefined){var n=this.select(function(o){return m==o.Value});if(n==-1){n=this.select(function(o){return m==o.Text})}if(n!=-1){this.previousValue=m}}else{return this.$input.val()}};a.list.common.call(this);a.list.initialize.call(this);b(document.documentElement).bind("mousedown",b.proxy(function(m){var o=this.dropDown.$element;var n=o&&o.parent().length>0;if(b.contains(this.element,m.target)||(n&&b.contains(o.parent()[0],m.target))){return}this.trigger.change();this.trigger.close()},this));this[this.enabled?"enable":"disable"]();function h(){clearTimeout(this.timeout);this.timeout=setTimeout(b.proxy(function(){j=""},this),1000)}function k(q){var p=this.trigger;var n=this.dropDown;var r=q.keyCode||q.which;if(q.altKey&&r==38){p.close();return}if(q.altKey&&r==40){p.open();return}if(r>34&&r<41){q.preventDefault();if(!n.$items){this.fill();return}var t=n.$items;var s=b(t[this.selectedIndex]);var m=(r==35)?t.last():(r==36)?t.first():(r==37||r==38)?s.prev():(r==39||r==40)?s.next():[];if(m.length){var o=m[0];this.select(o);n.scrollTo(o);if(!n.isOpened()){p.change()}}}if(r==8){h();q.preventDefault();j=j.slice(0,-1)}if(r==9||r==13||r==27){p.change();p.close()}}function l(n){var q=this.dropDown;var p=n.keyCode||n.charCode;if(p==0||b.inArray(p,a.list.keycodes)!=-1||n.ctrlKey||n.altKey||n.shiftKey){return}if(!q.$items){this.fill();return}var o=j;o+=String.fromCharCode(p);if(o){var m=c(this.data,q.$items,o);if(m){this.select(m);q.scrollTo(m)}j=o}h()}};b.fn.tDropDownList=function(f){return a.create(this,{name:"tDropDownList",init:function(h,g){return new a.dropDownList(h,g)},options:f})};b.fn.tDropDownList.defaults={effects:a.fx.slide.defaults(),accessible:false,index:0,enabled:true,encoded:true}})(jQuery);